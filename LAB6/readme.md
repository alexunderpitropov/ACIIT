# Лабораторная работа №6

## Тема: Простое развертывание EC2 и S3 на AWS с Terraform

**Дата:** 28.11.2025

**Студент:** Alexandr Pitropov

**Группа:** I2302

---

## Цель работы

Целью лабораторной работы является изучение процесса развертывания базовой инфраструктуры в AWS с использованием Terraform. В рамках работы студент создаёт EC2‑инстанс, приватный S3‑бакет, настраивает переменные, выходные данные, а также использует удалённый backend в виде S3‑бакета для хранения состояния.

---

## Подготовка окружения

Работа выполнялась в Windows 11 с использованием:

* **Terraform v1.14.0**
* **AWS CLI v2.32.6**
* Аккаунта AWS с IAM‑пользователем `terraform-user`

Проверка версий:

```
terraform --version
aws --version
```

Настройка AWS CLI:

```
aws configure
```

Проверка авторизации:

```
aws sts get-caller-identity
```

---

## Структура проекта Terraform

Была создана директория `aws_lab6`, содержащая файлы:

* `main.tf` — описание провайдера, backend и ресурсов
* `variables.tf` — входные переменные
* `terraform.tfvars` — значения переменных
* `outputs.tf` — выходные данные

---

## Настройка backend (хранение состояния)

Для хранения `terraform.tfstate` был вручную создан S3‑бакет:

* **my-tf-state-simple-sasha**

Backend настроен в `main.tf` и использует:

* регион: `eu-central-1`
* шифрование: включено
* путь к файлу состояния: `global/s3/terraform.tfstate`

---

## Конфигурация Terraform

В файле `main.tf` были настроены:

* провайдер `aws`
* backend `s3`
* генерация уникального ID для бакета (`random_id`)
* EC2‑инстанс `t2.micro` на Amazon Linux 2
* приватный S3‑бакет с тегом окружения

---

## Переменные

В `variables.tf` определены:

* `aws_region` (по умолчанию: `eu-central-1`)
* `env` (по умолчанию: `dev`)

В `terraform.tfvars` были заданы фактические значения.

---

## Выходные данные

В `outputs.tf` определены:

* публичный IP EC2 (`ec2_public_ip`)
* имя S3‑бакета (`bucket_name`)

После `terraform apply` были получены значения:

* **ec2_public_ip = 63.181.34.178**
* **bucket_name = my-simple-bucket-dev-7fc9f180**

---

## Выполнение Terraform

Последовательность выполнения:

### 1. Инициализация

```
terraform init
```

Backend успешно настроен, провайдеры загружены.

### 2. Планирование

```
terraform plan
```

План показал создание 3 ресурсов: EC2, S3 и random_id.

### 3. Применение конфигурации

```
terraform apply
```

Ресурсы были развернуты успешно.
В AWS Console появились:

* EC2‑инстанс `WebServer-dev`
* S3‑бакет `my-simple-bucket-dev-7fc9f180`
* S3‑backend бакет с файлом состояния

---

## Проверка в AWS Console

В процессе проверки было подтверждено:

* EC2 работает и имеет публичный IP
* S3‑бакет создан, доступ приватный
* backend‑бакет содержит terraform.tfstate

---

## Очистка ресурсов

Для удаления ресурсов выполнена команда:

```
terraform destroy
```

После успешного удаления вручную были очищены:

* EC2‑инстанс
* оба S3‑бакета
* файл состояния

AWS‑ресурсы полностью удалены.

---

## Выводы

В ходе выполнения лабораторной работы были достигнуты все цели:

* создана инфраструктура AWS (EC2 + S3) с помощью Terraform
* реализована структура конфигурации с переменными и outputs
* настроено хранение состояния в S3‑бакете
* инфраструктура успешно развернута и удалена
* подтверждены навыки использования команд Terraform (`init`, `plan`, `apply`, `destroy`)

Работа выполнена полностью и соответствует требованиям задания.

